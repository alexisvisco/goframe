// Package types ; CODE GENERATED BY goframe; DO NOT EDIT
package types

import (
	"context"
	"time"

	"gorm.io/datatypes"
)

// UserCode is used for various one-time operations such as email verification.
type UserCode struct {
	ID        string
	UserID    string
	Kind      UserCodeKind
	ExpiresAt time.Time
	CreatedAt time.Time
	Metadata  datatypes.JSONMap
}

// UserCodeKind describes the purpose of a user code.
type UserCodeKind string

const (
	UserCodeKindEmailVerification UserCodeKind = "email_verification"
	UserCodeKindPasswordReset     UserCodeKind = "password_reset"
	UserCodeKindMagicLink         UserCodeKind = "magic_link"
	UserCodeKindOAuthProvider     UserCodeKind = "oauth_provider"
	UserCodeKindUnspecified       UserCodeKind = ""
)

// UserCodeService provides access to the user code storage.
type UserCodeService interface {
	GenerateCode(ctx context.Context, userID string, kind UserCodeKind, ttl time.Time, metadata datatypes.JSONMap) (*UserCode, error)
	ValidateCode(ctx context.Context, userID string, code string, kind UserCodeKind) (bool, error)
	GetCode(ctx context.Context, userID string, code string, kind UserCodeKind) (*UserCode, error)
	DeleteCode(ctx context.Context, userID string, code string, kind UserCodeKind) error
}
